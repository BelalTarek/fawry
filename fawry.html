<script src="./waleed.json" type='text/javascript'></script>
<!-- <script src="swagger-client/js/waleed.js" type='text/javascript'></script> -->

<script type="text/javascript">
    $(function(){
        console.log("f");
        
        $.getJSON('./waleed.json',function(data){ 
            console.log('success' , data);
        });
    });
</script>

<script type="text/x-red" data-template-name="fawryClinet-config">
    <div class="form-row">
        <label for="node-config-input-baseUrl"><i class="fa fa-bookmark"></i> <span data-i18n="fawryClient.label.baseUrl"></span></label>
        <input class="input-append-left" type="text" id="node-config-input-baseUrl" placeholder="localhost" style="width: 40%;" >
        <label for="node-config-input-port" style="margin-left: 10px; width: 35px; "> <span data-i18n="fawryClient.label.port"></span></label>
        <input type="text" id="node-config-input-port" style="width:45px">
    </div>
    <div class="form-row">
        <label for="node-config-input-user"><i class="fa fa-user"></i> <span data-i18n="fawryClient.label.username"></span></label>
        <input type="text" id="node-config-input-user">
    </div>
    <div class="form-row">
        <label for="node-config-input-password"><i class="fa fa-lock"></i> <span data-i18n="fawryClient.label.password"></span></label>
        <input type="password" id="node-config-input-password">
    </div>
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-config-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('fawryClinet-config', {
        category: 'config',
        color: "rgb(255, 247, 3)",
        defaults: {
            baseUrl: { value: "http://localhost/mohn", required: true },
            port: { value: 3000, required: true },
            name: { value: "" }
        },
        credentials: {
            user: { type: "text" },
            password: { type: "password" }
        },
        label: function () {
            return this.name || this.baseUrl + ":" + this.port
        }
    });
</script>


<style>
    table {
        border-collapse: collapse;
        font-size: 12px;
    }

    table td,
    table th {
        padding: 5px;
    }

    table th {
        border-bottom: 1px solid black;
    }

    table tr td:not(:first-child),
    table tr th:not(:first-child) {
        border-left: 1px solid black;
    }

    pre {
        font-size: 8px;
    }
</style>


 

<script type="text/x-red" data-template-name="fawryClient">
        <div class="form-row" id="swaggerclient-apirow">
            <label for="node-input-api"><i class="icon-tag"></i> <span data-i18n="fawryClient.label.api">API</span></label>
            <select type="text" id="node-input-api">
                <option value="" disabled selected data-i18n="fawryClient.placeholder.api">Select Your API</option>
                <option value="Pet" >Pet</option>
                <option value="Store" >Store</option>
                <option value="User" >User</option>
            </select>
        </div>
        <div class="form-row " id="swaggerclient-resourcerow">
            <label for="node-input-resource"><i class="icon-tag"></i> <span data-i18n="fawryClient.label.resource">Resource</span></label>
            <select type="text" id="node-input-resource">
                <option value="" disabled selected data-i18n="fawryClient.placeholder.resource">Select Your Resource</option>
                <option value="Pet">b</option>
                <option value="Pet">c</option>
                <option value="Pet">1</option>
                <option value="Store">2</option>
                <option value="Store">3</option>
                <option value="User">c</option>
            </select>
        </div>
        <div class="form-tips hidden" id="swaggerclient-urlwarningrow">
            <i class="fa fa-2x fa-warning"></i><span id="swaggerclient-urlwarningrow-message" style="padding: 10px; font-weight: bold"></span>
        </div>
        <div class="form-tips hidden" id="swaggerclient-urlerrorrow" style="background-color:#e49191;">
            <span class="fa-stack"><i class="fa fa-circle-o fa-stack-2x"></i><i class="fa fa-exclamation fa-stack-1x"></i></span><span id="swaggerclient-urlerrorrow-message" style="padding: 10px; font-weight: bold"></span>
        </div>
        <div class="hidden" id="swaggerclient-paramssection">
            <hr> 
            <h5 data-i18n="fawryClient.label.parameters">Parameters</h5>
            
            <div class="" id="swaggerclient-paramslist" style="margin-left:25px;">
                <table id="swaggerclient-paramslisttable" style="width: 100%">
                    <tr>
                        <th data-i18n="fawryClient.table.parameter">Parameter</th>
                        <th data-i18n="fawryClient.table.type">Type</th>
                        <th style="width: 225px" data-i18n="fawryClient.table.value">Value</th>
                    </tr>
                </table>
            </div>
        </div>
    </script>

    <!-- <script type="text/javascript">
    // function oneditprepare() {
        console.log("hey");

        let selectone = document.getElementById('node-input-api');
        console.log(selectone);
        
        var $select1 = $( '#node-input-api' ),
             $select2 = $( '#node-input-resource' ),
         $options = $select2.find( 'option' );
         
console.log($select1);

        //  $select2.html( $options.filter( '[value="' + $select1.value + '"]' ) );

     $select1.on( 'change', function() {
         $select2.html( $options.filter( '[value="' + this.value + '"]' ) );
     } ).trigger( 'change' );
    // }
     </script> -->

<script type="text/x-red" data-help-name="fawryClient">
        <p><b>A Node-RED wrapper for the swagger-client package.</b></p>
        <p>Allows the user to point to an online Swagger definition. It will then parse the Swagger doc and present the available APIs. After selecting an API, the user can select a resource and supply the parameters. The supplied configuration options will be saved in the node, and will be executed when the node receives input.</p>
        <p>In addition to supplying the parameters in the node configuration, you can also pass it from the msg object by supplying them in <code>msg.params.[param_key]</code></p>
    </script>


<script type="text/javascript">
    RED.nodes.registerType('fawryClient', {
        category: 'fawry',
        color: '#a6bbcf',
        defaults: {
            name: { value: "" },
            url: { value: "" },
            api: { value: "" },
            resource: { value: "" },
            params: { value: "" },
            fawryClient: { value: "" }
        },
        inputs: 1,
        outputs: 1,
        icon: "swagger_icon.png",
        label: function () {
            return this.name || "fawryClient";
        },
        oneditprepare: function() {
            console.log('mo7n');
            $('#node-input-api').change(function(){
                console.log("dd");
                            var $select1 = $( '#node-input-api' ),
             $select2 = $( '#node-input-resource' ),
        $options = [{key:'Pet',title:'get all'},
        {key:'Store',title:'get '},
        {key:'User',title:'all'}];

                list = $options.filter(one=> one.key === $select1.val()) ;
                console.log($select1.val(),list);
                $select2.empty()
        //  $select2.html( list);
         $.each(list, function(id,item) {
             console.log(id,item);
  $select2.append($("<option></option>")
     .attr("value", item.key).text(item.title));
         });
});

        },
        oneditsave: function() {
            console.log("dd");
            
            this.api = $('#node-input-api').val();
            console.log(this.api);
            
            
        }

    });
</script>